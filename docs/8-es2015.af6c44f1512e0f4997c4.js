(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{d7gL:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomerModule",(function(){return _}));var r=n("PCNd"),o=n("tyNb"),s=n("fXoL");let c=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Ib(o.b))},e.\u0275cmp=s.Cb({type:e,selectors:[["cm-orders"]],decls:27,vars:0,consts:[[1,"orders","view"],[1,"container"],[1,"glyphicon","glyphicon-user"],[1,"navbar"],[1,"nav","navbar-nav"],[1,"toolbar-item"],["routerLink","details","routerLinkActive","active"],[1,"glyphicon","glyphicon-list"],["routerLink","orders","routerLinkActive","active"],[1,"glyphicon","glyphicon-tags"],["routerLink","edit","routerLinkActive","active"],[1,"glyphicon","glyphicon-edit"],["routerLink","/customers"]],template:function(e,t){1&e&&(s.Mb(0,"div",0),s.Mb(1,"div",1),s.Mb(2,"header"),s.Mb(3,"h3"),s.Jb(4,"span",2),s.nc(5,"\xa0\xa0Customer Information"),s.Lb(),s.Lb(),s.Jb(6,"br"),s.Mb(7,"div",3),s.Mb(8,"ul",4),s.Mb(9,"li",5),s.Mb(10,"a",6),s.Jb(11,"span",7),s.nc(12,"\xa0\xa0Customer Details "),s.Lb(),s.Lb(),s.Mb(13,"li",5),s.Mb(14,"a",8),s.Jb(15,"span",9),s.nc(16,"\xa0\xa0Customer Orders "),s.Lb(),s.Lb(),s.Mb(17,"li",5),s.Mb(18,"a",10),s.Jb(19,"span",11),s.nc(20,"\xa0\xa0Edit Customer "),s.Lb(),s.Lb(),s.Lb(),s.Lb(),s.Mb(21,"div",1),s.Jb(22,"router-outlet"),s.Jb(23,"br"),s.Jb(24,"br"),s.Mb(25,"a",12),s.nc(26,"View all Customers"),s.Lb(),s.Lb(),s.Lb(),s.Lb())},directives:[o.d,o.c,o.f],encapsulation:2}),e})();var i=n("cplz"),a=n("ofXK"),b=n("vTEt");function u(e,t){if(1&e&&(s.Mb(0,"tr"),s.Mb(1,"td"),s.nc(2),s.Lb(),s.Mb(3,"td",6),s.nc(4),s.Wb(5,"currency"),s.Lb(),s.Lb()),2&e){const e=t.$implicit;s.xb(2),s.oc(e.productName),s.xb(2),s.oc(s.Yb(5,2,e.itemCost,"USD","symbol"))}}function l(e,t){if(1&e&&(s.Mb(0,"div",2),s.Mb(1,"h4"),s.nc(2),s.Wb(3,"capitalize"),s.Wb(4,"capitalize"),s.Lb(),s.Jb(5,"br"),s.Mb(6,"table",3),s.mc(7,u,6,6,"tr",4),s.Mb(8,"tr",5),s.Mb(9,"td"),s.nc(10,"\xa0"),s.Lb(),s.Mb(11,"td",6),s.nc(12),s.Wb(13,"currency"),s.Lb(),s.Lb(),s.Lb(),s.Lb()),2&e){const e=s.Vb();s.xb(2),s.qc("Orders for ",s.Xb(3,5,e.customer.firstName)," ",s.Xb(4,7,e.customer.lastName),""),s.xb(5),s.bc("ngForOf",e.customer.orders)("ngForTrackBy",e.ordersTrackBy),s.xb(5),s.oc(s.Yb(13,9,e.customer.orderTotal,"USD","symbol"))}}function d(e,t){1&e&&(s.Mb(0,"div",2),s.nc(1," No orders found "),s.Lb())}function m(e,t){1&e&&(s.Mb(0,"div",2),s.nc(1," No customer found "),s.Lb())}let g=(()=>{class e{constructor(e,t){this.route=e,this.dataService=t,this.orders=[]}ngOnInit(){this.route.parent.params.subscribe(e=>{this.dataService.getCustomer(+e.id).subscribe(e=>{this.customer=e})})}ordersTrackBy(e,t){return e}}return e.\u0275fac=function(t){return new(t||e)(s.Ib(o.a),s.Ib(i.a))},e.\u0275cmp=s.Cb({type:e,selectors:[["cm-customer-orders"]],decls:4,vars:3,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"table","table-striped","table-hover","orders-table"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"summary-border"],[1,"text-right"]],template:function(e,t){1&e&&(s.Mb(0,"div",0),s.mc(1,l,14,13,"div",1),s.mc(2,d,2,0,"div",1),s.mc(3,m,2,0,"div",1),s.Lb()),2&e&&(s.xb(1),s.bc("ngIf",t.customer&&t.customer.orders),s.xb(1),s.bc("ngIf",t.customer&&!t.customer.orders),s.xb(1),s.bc("ngIf",!t.customer))},directives:[a.l,a.k],pipes:[b.a,a.c],encapsulation:2}),e})();var f=n("mrSG");const p=["mapsContainer"];function h(e,t){if(1&e&&(s.Mb(0,"div",2),s.Mb(1,"div",6),s.Jb(2,"img",7),s.Wb(3,"lowercase"),s.Lb(),s.Mb(4,"div",8),s.Mb(5,"h4"),s.nc(6),s.Wb(7,"capitalize"),s.Wb(8,"capitalize"),s.Lb(),s.Jb(9,"br"),s.nc(10),s.Jb(11,"br"),s.nc(12),s.Lb(),s.Lb()),2&e){const e=s.Vb();s.xb(2),s.cc("src","assets/images/",s.Xb(3,6,e.customer.gender),".png",s.ic),s.xb(4),s.qc(" ",s.Xb(7,8,e.customer.firstName)," ",s.Xb(8,10,e.customer.lastName),"\xa0 "),s.xb(4),s.pc(" ",e.customer.address," "),s.xb(2),s.qc(" ",e.customer.city,", ",e.customer.state.name," ")}}function v(e,t){1&e&&(s.Mb(0,"div",0),s.nc(1," No customer found\n"),s.Lb())}let M=(()=>{class e{constructor(e,t,n){this.route=e,this.dataService=t,this.componentFactoryResolver=n}ngOnInit(){this.route.parent.params.subscribe(e=>{const t=+e.id;t&&this.dataService.getCustomer(t).subscribe(e=>{this.customer=e,this.customer&&this.customer.latitude&&this.lazyLoadMapComponent()})})}lazyLoadMapComponent(){return Object(f.a)(this,void 0,void 0,(function*(){if(!this.mapsViewContainerRef.length){const{MapComponent:e}=yield n.e(2).then(n.bind(null,"ISAC"));console.log("Lazy loaded map component!");const t=this.componentFactoryResolver.resolveComponentFactory(e);this.mapComponentRef=this.mapsViewContainerRef.createComponent(t),this.mapComponentRef.instance.zoom=10,this.mapComponentRef.instance.customer=this.customer,this.mapComponentRef.instance.enabled=!0}}))}}return e.\u0275fac=function(t){return new(t||e)(s.Ib(o.a),s.Ib(i.a),s.Ib(s.j))},e.\u0275cmp=s.Cb({type:e,selectors:[["cm-customer-details"]],viewQuery:function(e,t){var n;1&e&&s.rc(p,!0,s.O),2&e&&s.fc(n=s.Ub())&&(t.mapsViewContainerRef=n.first)},decls:10,vars:2,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-12"],["mapsContainer",""],["class","container",4,"ngIf"],[1,"col-md-2"],[1,"details-image",3,"src"],[1,"col-md-10"]],template:function(e,t){1&e&&(s.Mb(0,"div",0),s.mc(1,h,13,12,"div",1),s.Jb(2,"br"),s.Jb(3,"br"),s.Mb(4,"div",2),s.Mb(5,"div",3),s.Mb(6,"div"),s.Kb(7,null,4),s.Lb(),s.Lb(),s.Lb(),s.Lb(),s.mc(9,v,2,0,"div",5)),2&e&&(s.xb(1),s.bc("ngIf",t.customer),s.xb(8),s.bc("ngIf",!t.customer))},directives:[a.l],pipes:[a.i,b.a],styles:[".details-image[_ngcontent-%COMP%]{height:100px;width:100px;margin-top:10px}"]}),e})();var L=n("+qzk"),C=n("9nld"),y=n("OsF4"),x=n("3Pt+");const w=["customerForm"];function I(e,t){if(1&e&&(s.Mb(0,"option",16),s.nc(1),s.Lb()),2&e){const e=t.$implicit;s.bc("ngValue",e.abbreviation),s.xb(1),s.oc(e.name)}}function k(e,t){if(1&e){const e=s.Nb();s.Mb(0,"div",20),s.nc(1," Delete Customer?\xa0\xa0"),s.Mb(2,"button",21),s.Tb("click",(function(t){return s.hc(e),s.Vb(2).delete(t)})),s.nc(3,"Yes"),s.Lb(),s.nc(4,"\xa0\xa0 "),s.Mb(5,"button",22),s.Tb("click",(function(){return s.hc(e),s.Vb(2).deleteMessageEnabled=!1})),s.nc(6,"No"),s.Lb(),s.Lb()}}function N(e,t){if(1&e){const e=s.Nb();s.Mb(0,"button",21),s.Tb("click",(function(){return s.hc(e),s.Vb(2).deleteMessageEnabled=!0})),s.nc(1,"Delete"),s.Lb()}}function O(e,t){if(1&e){const e=s.Nb();s.Mb(0,"div",23),s.Mb(1,"button",22),s.Tb("click",(function(t){return s.hc(e),s.Vb(2).cancel(t)})),s.nc(2,"Cancel"),s.Lb(),s.nc(3,"\xa0\xa0 "),s.Mb(4,"button",24),s.nc(5),s.Lb(),s.Lb()}if(2&e){const e=s.Vb(2),t=s.gc(2);s.xb(4),s.bc("disabled",t.pristine||!t.valid),s.xb(1),s.oc(e.operationText)}}function S(e,t){if(1&e&&(s.Mb(0,"div"),s.mc(1,k,7,0,"div",17),s.mc(2,N,2,0,"button",18),s.nc(3,"\xa0\xa0 "),s.mc(4,O,6,2,"div",19),s.Lb()),2&e){const e=s.Vb();s.xb(1),s.bc("ngIf",e.customer.id&&e.deleteMessageEnabled),s.xb(1),s.bc("ngIf",e.customer.id&&!e.deleteMessageEnabled),s.xb(2),s.bc("ngIf",!e.deleteMessageEnabled)}}function F(e,t){if(1&e&&(s.Mb(0,"div",25),s.nc(1),s.Lb()),2&e){const e=s.Vb();s.xb(1),s.oc(e.errorMessage)}}let T=(()=>{class e{constructor(e,t,n,r,o,s){this.router=e,this.route=t,this.dataService=n,this.growler=r,this.modalService=o,this.logger=s,this.customer={id:0,firstName:"",lastName:"",gender:"",address:"",city:"",state:{abbreviation:"",name:""}},this.operationText="Insert"}ngOnInit(){this.route.parent.params.subscribe(e=>{const t=+e.id;0!==t&&(this.operationText="Update",this.getCustomer(t))}),this.dataService.getStates().subscribe(e=>this.states=e)}getCustomer(e){this.dataService.getCustomer(e).subscribe(e=>{this.customer=e})}submit(){0===this.customer.id?this.dataService.insertCustomer(this.customer).subscribe(e=>{if(e)this.customerForm.form.markAsPristine(),this.router.navigate(["/customers"]);else{const e="Unable to insert customer";this.growler.growl(e,L.a.Danger),this.errorMessage=e}},e=>this.logger.log(e)):this.dataService.updateCustomer(this.customer).subscribe(e=>{if(e)this.customerForm.form.markAsPristine(),this.growler.growl("Operation performed successfully.",L.a.Success);else{const e="Unable to update customer";this.growler.growl(e,L.a.Danger),this.errorMessage=e}},e=>this.logger.log(e))}cancel(e){e.preventDefault(),this.router.navigate(["/customers"])}delete(e){e.preventDefault(),this.dataService.deleteCustomer(this.customer.id).subscribe(e=>{e?this.router.navigate(["/customers"]):this.errorMessage="Unable to delete customer"},e=>this.logger.log(e))}canDeactivate(){return!this.customerForm.dirty||this.modalService.show({header:"Lose Unsaved Changes?",body:"You have unsaved changes! Would you like to leave the page and lose them?",cancelButtonText:"Cancel",OKButtonText:"Leave"})}}return e.\u0275fac=function(t){return new(t||e)(s.Ib(o.b),s.Ib(o.a),s.Ib(i.a),s.Ib(L.b),s.Ib(C.a),s.Ib(y.a))},e.\u0275cmp=s.Cb({type:e,selectors:[["cm-customer-edit"]],viewQuery:function(e,t){var n;1&e&&s.kc(w,!0),2&e&&s.fc(n=s.Ub())&&(t.customerForm=n.first)},decls:39,vars:12,consts:[["novalidate","",1,"customer-form",3,"ngSubmit"],["customerForm","ngForm"],[1,"form-group"],["type","text","name","firstName","required","",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],[1,"alert","alert-danger",3,"hidden"],["type","text","name","lastName","required","",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],["type","text","name","address","required","",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],["type","text","name","city","required","",1,"form-control",3,"ngModel","ngModelChange"],["city","ngModel"],["name","state","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[3,"ngValue"],["class","alert alert-warning",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","pull-right",4,"ngIf"],[1,"alert","alert-warning"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-default",3,"click"],[1,"pull-right"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"alert","alert-danger"]],template:function(e,t){if(1&e&&(s.Mb(0,"div"),s.Mb(1,"form",0,1),s.Tb("ngSubmit",(function(){return t.submit()})),s.Mb(3,"div",2),s.Mb(4,"label"),s.nc(5,"First Name"),s.Lb(),s.Mb(6,"input",3,4),s.Tb("ngModelChange",(function(e){return t.customer.firstName=e})),s.Lb(),s.Mb(8,"div",5),s.nc(9,"First Name is required"),s.Lb(),s.Lb(),s.Mb(10,"div",2),s.Mb(11,"label"),s.nc(12,"Last Name"),s.Lb(),s.Mb(13,"input",6,7),s.Tb("ngModelChange",(function(e){return t.customer.lastName=e})),s.Lb(),s.Mb(15,"div",5),s.nc(16,"Last Name is required"),s.Lb(),s.Lb(),s.Mb(17,"div",2),s.Mb(18,"label"),s.nc(19,"Address"),s.Lb(),s.Mb(20,"input",8,9),s.Tb("ngModelChange",(function(e){return t.customer.address=e})),s.Lb(),s.Mb(22,"div",5),s.nc(23,"Address is required"),s.Lb(),s.Lb(),s.Mb(24,"div",2),s.Mb(25,"label"),s.nc(26,"City"),s.Lb(),s.Mb(27,"input",10,11),s.Tb("ngModelChange",(function(e){return t.customer.city=e})),s.Lb(),s.Mb(29,"div",5),s.nc(30,"City is required"),s.Lb(),s.Lb(),s.Mb(31,"div",2),s.Mb(32,"label"),s.nc(33,"State"),s.Lb(),s.Mb(34,"select",12),s.Tb("ngModelChange",(function(e){return t.customer.state.abbreviation=e})),s.mc(35,I,2,2,"option",13),s.Lb(),s.Lb(),s.mc(36,S,5,3,"div",14),s.mc(37,F,2,1,"div",15),s.Lb(),s.Jb(38,"br"),s.Lb()),2&e){const e=s.gc(7),n=s.gc(14),r=s.gc(21),o=s.gc(28);s.xb(6),s.bc("ngModel",t.customer.firstName),s.xb(2),s.bc("hidden",e.pristine||e.valid),s.xb(5),s.bc("ngModel",t.customer.lastName),s.xb(2),s.bc("hidden",n.pristine||n.valid),s.xb(5),s.bc("ngModel",t.customer.address),s.xb(2),s.bc("hidden",r.pristine||r.valid),s.xb(5),s.bc("ngModel",t.customer.city),s.xb(2),s.bc("hidden",o.pristine||o.valid),s.xb(5),s.bc("ngModel",t.customer.state.abbreviation),s.xb(1),s.bc("ngForOf",t.states),s.xb(1),s.bc("ngIf",t.customer),s.xb(1),s.bc("ngIf",null!=t.errorMessage)}},directives:[x.r,x.h,x.i,x.b,x.n,x.g,x.j,x.o,a.k,a.l,x.k,x.q],styles:[".customer-form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}.customer-form[_ngcontent-%COMP%]   .ng-invalid[_ngcontent-%COMP%]{border-left:5px solid #a94442}.customer-form[_ngcontent-%COMP%]   .ng-valid[_ngcontent-%COMP%]{border-left:5px solid #42a948}"]}),e})();var P=n("7dP1");let J=(()=>{class e{constructor(e,t){this.authService=e,this.router=t}canActivate(e,t){return!!this.authService.isAuthenticated||(this.authService.redirectUrl=t.url,this.router.navigate(["/login"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.Qb(P.a),s.Qb(o.b))},e.\u0275prov=s.Eb({token:e,factory:e.\u0275fac}),e})(),V=(()=>{class e{constructor(e){this.logger=e}canDeactivate(e,t,n){return this.logger.log(`CustomerId: ${t.parent.params.id} URL: ${n.url}`),e.canDeactivate()}}return e.\u0275fac=function(t){return new(t||e)(s.Qb(y.a))},e.\u0275prov=s.Eb({token:e,factory:e.\u0275fac}),e})();const q=[{path:"",component:c,children:[{path:"orders",component:g},{path:"details",component:M},{path:"edit",component:T,canActivate:[J],canDeactivate:[V]}]}];let D=(()=>{class e{}return e.components=[c,g,M,T],e.\u0275mod=s.Gb({type:e}),e.\u0275inj=s.Fb({factory:function(t){return new(t||e)},providers:[J,V],imports:[[o.e.forChild(q)],o.e]}),e})(),_=(()=>{class e{}return e.\u0275mod=s.Gb({type:e}),e.\u0275inj=s.Fb({factory:function(t){return new(t||e)},imports:[[D,r.a]]}),e})()}}]);